'use strict'
const assert = require('assert')
const iniciar = require('../lib/iniciar')
const setPackageDataFromCli = iniciar.setPackageDataFromCli
const getTypeDependency = iniciar.getTypeDependency
const dependencies = require('../generators/dependencies')
const defaultJSON = require('../generators/default/default.json')

describe('iniciar', function () {
  describe('#getTypeDependency()', function () {
    it('should return a preper type dependency for cli', function () {
      const actual = getTypeDependency('cli', 'meow')
      const expected = dependencies.cli.meow

      assert.deepEqual(actual, expected)
    })
  })

  describe('#setPackageDataFromCli()', function () {
    it('should update the package info with flags', function () {
      const flags = {
        output: '/home/user/Desktop/helloWorld',
        name: 'helloWorld',
        main: 'cli.js',
        ver: '0.0.1' // alias
      }
      const generator = defaultJSON
      const expected = {
        name: 'helloWorld',
        version: '0.0.1',
        description: '',
        main: 'cli.js',
        scripts: {
          test: 'echo "Error: no test specified" && exit 1'
        },
        keywords: [],
        author: '',
        license: 'ISC'
      }
      let actual = generator.package

      setPackageDataFromCli(actual, flags)

      assert.deepEqual(actual, expected)
    })
  })
})
