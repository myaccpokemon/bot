#!/usr/bin/env node
'use strict'
const meow = require('meow')
const chalk = require('chalk')
const log = require('./lib/logs.js').log
const iniciar = require('./lib/iniciar.js')

const cli = meow(
`
    Usage
      $ iniciar [generator] [options]

    Options
      -l, --list            Display available generators
      -o, --output          Output directory
      -c  --ci  [house]     (travis) Add CI default configuration
          --cli [package]   Add CLI app helper dependency
      -h, --help            Display this help and exit

      Change package.json project values:
          [--key]  <value>

      Defaults:
      -n, --name   name     ("")
          --main   main     (index.js)
          --ver    version  (1.0.0)

    Examples:
      $ iniciar node-mocha -o ~/Desktop/helloWorld --ci

`, {
  alias: {
    o: 'output',
    c: 'ci',
    n: 'name',
    h: 'help',
    l: 'list'
  }
})

if (cli.flags.list) {
  const list = require('./generators/list.json')
  listGenerators(list)
} else {
  iniciar.init(cli)
}

function listGenerators (list) {
  const docsUrl = 'https://github.com/juliomatcom/iniciar/blob/master/docs/generators.md'
  log(chalk.bold('Available generators:'))
  list.forEach(function (filename) {
    log(chalk.green(` üèπ `) + filename)
  })
  log(`\nRead more: ${docsUrl}`)
}
